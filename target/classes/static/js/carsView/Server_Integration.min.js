var Communicator;
(function(b){var d=function(){function a(c){this._endpoint=c}a.prototype.request=function(c){var a=this,b=new XMLHttpRequest;b.open("POST",this._endpoint+"/service");b.setRequestHeader("Access-Control-Allow-Origin","*");b.setRequestHeader("Access-Control-Allow-Methods","POST");b.setRequestHeader("Access-Control-Allow-Headers","Content-Type, Access-Control-Allow-Origin, Access-Control-Allow-Methods, Access-Control-Allow-Headers");b.timeout=6E4;return new Promise(function(f,e){b.onreadystatechange=function(){4==
b.readyState&&(200==b.status?f(a._parseServerSuccessResponse(b.responseText)):e(a._parseServerError(b)))};b.send(a._encodeServiceRequest(c))})};a.prototype._encodeServiceRequest=function(c){var a={params:{}};switch(c.getServiceClass()){case b.ServiceClass.CSR_Session:a["class"]="csr_session";break;case b.ServiceClass.SSR_Session:a["class"]="ssr_session"}c=c.getModelSearchDirectories();0<c.length&&(a.params.modelSearchDirectories=c);return JSON.stringify(a)};a.prototype._parseServerSuccessResponse=
function(c){var a=new b.ServiceResponse;c=JSON.parse(c);a._setIsOk("ok"==c.result);if(a.getIsOk()){a._setServiceId(c.serviceId);for(var d=Object.keys(c.endpoints),g=a.getEndpoints(),e=0;e<d.length;e++)g[b.ServiceProtocol[d[e].toUpperCase()]]=c.endpoints[d[e]]}else a._setReason(c.reason);return a};a.prototype._parseServerError=function(a){a=new b.ServiceResponse;a._setIsOk(!1);a._setReason("Server error encountered when trying to connect to: "+this._endpoint);return a};return a}();b.ServiceBroker=
d})(Communicator||(Communicator={}));
(function(b){(function(a){a[a.CSR_Session=0]="CSR_Session";a[a.SSR_Session=1]="SSR_Session"})(b.ServiceClass||(b.ServiceClass={}));var d=b.ServiceClass,a=function(){function a(a){void 0===a&&(a=d.CSR_Session);this._modelSearchDirectories=[];this._serviceClass=a}a.prototype.setServiceClass=function(a){this._serviceClass=a};a.prototype.getServiceClass=function(){return this._serviceClass};a.prototype.addModelSearchDirectory=function(a){this._modelSearchDirectories.push(a)};a.prototype.getModelSearchDirectories=
function(){return this._modelSearchDirectories.slice()};return a}();b.ServiceRequest=a})(Communicator||(Communicator={}));
(function(b){(function(a){a[a.WS=0]="WS";a[a.WSS=1]="WSS";a[a.HTTP=2]="HTTP";a[a.HTTPS=3]="HTTPS"})(b.ServiceProtocol||(b.ServiceProtocol={}));var d=function(){function a(){this._isOk=!1;this._serviceId=this._reason=null;this._endpoints={}}a.prototype.getIsOk=function(){return this._isOk};a.prototype.getReason=function(){return this._reason};a.prototype.getServiceId=function(){return this._serviceId};a.prototype.getEndpoints=function(){return this._endpoints};a.prototype._setIsOk=function(a){this._isOk=
a};a.prototype._setReason=function(a){this._reason=a};a.prototype._setServiceId=function(a){this._serviceId=a};a.prototype._addEndpoint=function(a,b){this._endpoints[a]=b};return a}();b.ServiceResponse=d})(Communicator||(Communicator={}));